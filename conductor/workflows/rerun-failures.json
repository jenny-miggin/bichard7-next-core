[
  {
    "accessPolicy": {},
    "name": "rerun_failures",
    "description": "Compares a batch of failed comparison S3 files against Core",
    "version": 1,
    "tasks": [
      {
        "name": "generate_rerun_failures_tasks",
        "taskReferenceName": "generate_rerun_failures_tasks_ref",
        "inputParameters": {
          "startDate": "${workflow.input.startDate}",
          "endDate": "${workflow.input.endDate}",
          "taskName": "rerun_failure_day"
        },
        "type": "SIMPLE",
        "startDelay": 0,
        "optional": false,
        "asyncComplete": false
      },
      {
        "name": "rerun_failure_day",
        "taskReferenceName": "rerun_failure_day_ref",
        "inputParameters": {
          "dynamicTasks": "${generate_rerun_failures_tasks_ref.output.dynamicTasks}",
          "dynamicTasksInput": "${generate_rerun_failures_tasks_ref.output.dynamicTasksInput}"
        },
        "type": "FORK_JOIN_DYNAMIC",
        "dynamicForkTasksParam": "dynamicTasks",
        "dynamicForkTasksInputParamName": "dynamicTasksInput",
        "startDelay": 0,
        "optional": false,
        "asyncComplete": false
      },
      {
        "name": "rerun_failures_join",
        "taskReferenceName": "rerun_failures_join_ref",
        "inputParameters": {},
        "type": "JOIN",
        "startDelay": 0,
        "optional": false,
        "asyncComplete": false
      },
      {
        "name": "aggregate_results",
        "taskReferenceName": "aggregate_results_ref",
        "inputParameters": {
          "results": "${rerun_failures_join_ref.output}",
          "queryExpression": ".results | map(to_entries) | add | group_by(.key) | map({ key: .[0].key, value: map(.value) | add }) | from_entries"
        },
        "type": "JSON_JQ_TRANSFORM"
      }
    ],
    "inputParameters": ["startDate", "endDate"],
    "outputParameters": {
      "pass": "${aggregate_results_ref.output.result.pass}",
      "fail": "${aggregate_results_ref.output.result.fail}"
    },
    "schemaVersion": 2,
    "restartable": true,
    "workflowStatusListenerEnabled": false,
    "ownerEmail": "moj-bichard7@madetech.com",
    "timeoutPolicy": "ALERT_ONLY",
    "timeoutSeconds": 0,
    "variables": {},
    "inputTemplate": {}
  }
]
